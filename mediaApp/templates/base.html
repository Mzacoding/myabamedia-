<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ newspaper_name }} | {{ company_name }}{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#667eea',
                        secondary: '#764ba2',
                        accent: '#3498db'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'serif': ['Playfair Display', 'Georgia', 'serif'],
                        'display': ['Playfair Display', 'Georgia', 'serif']
                    },
                    fontSize: {
                        'xs': ['0.75rem', { lineHeight: '1.5' }],
                        'sm': ['0.875rem', { lineHeight: '1.6' }],
                        'base': ['1rem', { lineHeight: '1.7' }],
                        'lg': ['1.125rem', { lineHeight: '1.7' }],
                        'xl': ['1.25rem', { lineHeight: '1.6' }],
                        '2xl': ['1.5rem', { lineHeight: '1.5' }],
                        '3xl': ['1.875rem', { lineHeight: '1.4' }],
                        '4xl': ['2.25rem', { lineHeight: '1.3' }],
                        '5xl': ['3rem', { lineHeight: '1.2' }],
                        '6xl': ['3.75rem', { lineHeight: '1.1' }]
                    }
                }
            }
        }
    </script>
    {% load static %}
    <link rel="icon" href="{% static 'images/MyabaLogo.png' %}" type="image/png">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/professional-enhancements.css' %}">
    <link rel="stylesheet" href="{% static 'css/modern-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/quick-fixes.css' %}">
    <link rel="stylesheet" href="{% static 'css/premium-footer.css' %}">
    <link rel="stylesheet" href="{% static 'css/professional-typography.css' %}">
    <link rel="stylesheet" href="{% static 'css/services-fix.css' %}">
    <link rel="stylesheet" href="{% static 'css/remove-icons.css' %}">
    
    <!-- Instant Features Script (loads immediately) -->
    <script src="{% static 'js/instant-features.js' %}"></script>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}Professional ICT, media, and publishing services in Nkangala District Municipality. Web development, graphic design, and news publishing by Myaba Media Tech.{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}web development, graphic design, news publishing, ICT services, Nkangala District, Myaba Media Tech, The Highveld Chronicle{% endblock %}">
    <meta name="author" content="Myaba Media Tech">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{{ newspaper_name }} | {{ company_name }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Professional ICT, media, and publishing services in Nkangala District Municipality.{% endblock %}">
    <meta property="og:image" content="{% static 'images/MyabaLogo.png' %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}{{ newspaper_name }} | {{ company_name }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Professional ICT, media, and publishing services in Nkangala District Municipality.{% endblock %}">
    <meta name="twitter:image" content="{% static 'images/MyabaLogo.png' %}">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen">
        <div class="loader"></div>
    </div>
    
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    {% include 'header.html' %}
    
    <!-- Messages Display -->
    {% if messages %}
        <div class="messages" id="messages-container">
            {% for message in messages %}
                <div class="message {{ message.tags }} fade-in" role="alert">
                    {{ message }}
                    <button type="button" class="message-close" onclick="this.parentElement.remove()" aria-label="Close message">&times;</button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <main id="main-content" class="pt-16">
        {% block content %}
        {# Content from child templates will go here #}
        {% endblock %}
    </main>

    {% include 'footer.html' %} {# Corrected: Include the footer partial from mediaApp #}
<aside id="sideNav" class="fixed inset-y-0 right-0 z-50 w-80 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out md:hidden">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-6 border-b">
                <div class="flex items-center space-x-3">
                    <img src="{% static 'images/MyabaLogo.png' %}" alt="Myaba Media Tech" class="h-8 w-auto">
                    <span class="text-lg font-semibold text-gray-900">Menu</span>
                </div>
                <button id="closeSideNav" class="text-gray-400 hover:text-gray-600">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <nav class="flex-1 px-6 py-6 space-y-2">
                <a href="{% url 'home' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-home mr-3 text-primary"></i>Home
                </a>
                <a href="{% url 'about' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-info-circle mr-3 text-primary"></i>About Us
                </a>
                <a href="{% url 'services' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-cogs mr-3 text-primary"></i>Services
                </a>
                <a href="{% url 'portfolio' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-briefcase mr-3 text-primary"></i>Portfolio
                </a>
                <a href="{% url 'news' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-newspaper mr-3 text-primary"></i>News
                </a>
                <a href="{% url 'contact' %}" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-envelope mr-3 text-primary"></i>Contact
                </a>
            </nav>
            
            <div class="p-6 border-t bg-gray-50">
                <h4 class="text-sm font-semibold text-gray-900 mb-3">Get In Touch</h4>
                <div class="space-y-2 text-sm text-gray-600">
                    <p class="flex items-center"><i class="fas fa-phone mr-2 text-primary"></i>{{ phone }}</p>
                    <p class="flex items-center"><i class="fas fa-envelope mr-2 text-primary"></i>{{ email }}</p>
                </div>
                <div class="flex space-x-3 mt-4">
                    <a href="https://wa.me/{{ phone|cut:'+' }}" class="text-green-500 hover:text-green-600">
                        <i class="fab fa-whatsapp text-xl"></i>
                    </a>
                    <a href="tel:{{ phone }}" class="text-blue-500 hover:text-blue-600">
                        <i class="fas fa-phone text-xl"></i>
                    </a>
                    <a href="mailto:{{ email }}" class="text-red-500 hover:text-red-600">
                        <i class="fas fa-envelope text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </aside>

    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden"></div>
    <script>
        // Simple client-side active link highlighting for single-page style if needed,
        // though Django's URL matching handles it for full page loads.
        // This JS would be for smoother SPA-like transitions if you implemented them.
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-hide messages after 5 seconds
            const messages = document.querySelectorAll('.message');
            messages.forEach(function(message) {
                setTimeout(function() {
                    if (message.parentElement) {
                        message.style.opacity = '0';
                        message.style.transform = 'translateX(100%)';
                        setTimeout(function() {
                            if (message.parentElement) {
                                message.remove();
                            }
                        }, 300);
                    }
                }, 5000);
            });
            
            // Enhanced form submission with loading states
            const forms = document.querySelectorAll('form');
            forms.forEach(function(form) {
                form.addEventListener('submit', function(e) {
                    const submitBtn = form.querySelector('button[type="submit"], input[type="submit"]');
                    if (submitBtn && !submitBtn.classList.contains('loading')) {
                        submitBtn.classList.add('loading');
                        submitBtn.disabled = true;
                        
                        // Re-enable after 10 seconds as fallback
                        setTimeout(function() {
                            submitBtn.classList.remove('loading');
                            submitBtn.disabled = false;
                        }, 10000);
                    }
                });
            });
            
            // Add fade-in animation to page elements
            const animatedElements = document.querySelectorAll('.key-service-item, .testimonial-item, .service-item');
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('fade-in');
                    }
                });
            }, { threshold: 0.1 });
            
            animatedElements.forEach(function(el) {
                observer.observe(el);
            });
            const navLinks = document.querySelectorAll('.nav a');
            navLinks.forEach(link => {
                // Ensure a smooth scroll to anchor when clicked
                link.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href && href.startsWith('#')) {
                        e.preventDefault(); // Prevent default anchor jump

                        const targetElement = document.querySelector(href);
                        if (targetElement) {
                            const headerOffset = document.querySelector('.header').offsetHeight; // Get header height
                            const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
                            const offsetPosition = elementPosition - headerOffset;

                            window.scrollTo({
                                top: offsetPosition,
                                behavior: "smooth"
                            });
                        }
                    }
                });
            });
// --- Dynamic Hero Slider JavaScript ---
            // This script handles the dynamic changing of background images and text
            // for the hero section on the home page.
            const heroSection = document.getElementById('hero');
            const heroH1 = heroSection ? heroSection.querySelector('.dynamic-h1') : null;
            const heroH2 = heroSection ? heroSection.querySelector('.dynamic-h2') : null;
            const heroP = heroSection ? heroSection.querySelector('.dynamic-p') : null;


            let slidesData = [];
            // Check if the current page is the home page by looking for the slides-data element
            const slidesDataElement = document.getElementById('slides-data');
            if (slidesDataElement) {
                try {
                    slidesData = JSON.parse(slidesDataElement.textContent);
                    console.log('Slides Data Loaded:', slidesData);
                } catch (error) {
                    console.error('Error parsing slides data:', error);
                }
            } else {
                console.warn('slides-data script element not found. This is expected if not on the home page.');
            }

            let currentSlideIndex = 0;

            // Only run the slider logic if we are on the home page AND slides data is available
            if (heroSection && heroH1 && heroH2 && heroP && slidesData.length > 0) {
                // Function to update the hero content
                function updateHeroContent() {
                    const nextSlide = slidesData[currentSlideIndex];
                    console.log('Updating to slide:', currentSlideIndex, nextSlide);

                    // Apply fade-out effect for text elements
                    if (heroH1) { heroH1.style.opacity = 0; heroH1.style.transform = 'translateY(20px)'; }
                    if (heroH2) { heroH2.style.opacity = 0; heroH2.style.transform = 'translateY(20px)'; }
                    if (heroP) { heroP.style.opacity = 0; heroP.style.transform = 'translateY(20px)'; }


                    // Update text content
                    if (heroH1) heroH1.textContent = nextSlide.h1_text;
                    if (heroH2) heroH2.textContent = nextSlide.h2_text;
                    if (heroP) heroP.textContent = nextSlide.p_text;


                    // Set the new background image with a smooth transition
                    heroSection.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('${nextSlide.image_url}')`;

                    // Staggered fade-in for text elements
                    const textAnimationStartDelay = 1000; // Delay before text animation starts (after background change begins)
                    const textStaggerDelay = 300; // Delay between each text element appearing

                    setTimeout(() => {
                        if (heroH1) { heroH1.style.opacity = 1; heroH1.style.transform = 'translateY(0)'; }
                    }, textAnimationStartDelay);
                    setTimeout(() => {
                        if (heroH2) { heroH2.style.opacity = 1; heroH2.style.transform = 'translateY(0)'; }
                    }, textAnimationStartDelay + textStaggerDelay);
                    setTimeout(() => {
                        if (heroP) { heroP.style.opacity = 1; heroP.style.transform = 'translateY(0)'; }
                    }, textAnimationStartDelay + (textStaggerDelay * 2));
                    // The button is now always visible and does not animate with the text


                    currentSlideIndex = (currentSlideIndex + 1) % slidesData.length;
                    console.log('Text updated and faded in with staggered animation.');
                }

                // Initial content load
                updateHeroContent();

                // Set interval for changing content
                // Increased duration from 5000ms to 8000ms for a more relaxed pace
                setInterval(updateHeroContent, 8000); // Changed to 8 seconds
            } else {
                console.warn('Hero section elements or slides data not found. Slider will not run.');
                console.log('heroSection:', heroSection);
                console.log('heroH1:', heroH1);
                console.log('heroH2:', heroH2);
                console.log('heroP:', heroP);
                console.log('slidesData.length:', slidesData.length);
            }

            // --- Mobile Navigation JavaScript ---
            const menuToggle = document.getElementById('menuToggle');
            const sideNav = document.getElementById('sideNav');
            const overlay = document.getElementById('overlay');
            // The sideNavLinks query is now guarded to prevent errors if sideNav is null
            const sideNavLinks = sideNav ? sideNav.querySelectorAll('a') : [];

            function toggleMenu() {
                // Add checks to ensure elements exist before toggling classes
                if (menuToggle) menuToggle.classList.toggle('open');
                if (sideNav) sideNav.classList.toggle('open');
                if (overlay) overlay.classList.toggle('active');
                document.body.classList.toggle('no-scroll');
            }

            if (menuToggle) {
                menuToggle.addEventListener('click', toggleMenu);
            }
            if (overlay) {
                overlay.addEventListener('click', toggleMenu); // Close when clicking outside
            }

            // Close side nav when a link is clicked (for single-page navigation)
            sideNavLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (sideNav && sideNav.classList.contains('open')) { // Ensure sideNav exists before checking class
                        toggleMenu();
                    }
                });
            });
            
            // Smooth scroll for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(function(anchor) {
                anchor.addEventListener('click', function(e) {
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        e.preventDefault();
                        const headerOffset = 80;
                        const elementPosition = target.getBoundingClientRect().top + window.pageYOffset;
                        const offsetPosition = elementPosition - headerOffset;
                        
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });
    </script>
    
    <!-- Modern Features Script -->
    <script src="{% static 'js/modern-features.js' %}"></script>
    <script src="{% static 'js/tailwind-nav.js' %}"></script>
</body>
</html>
